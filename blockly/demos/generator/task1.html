<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <link href="demo.css" rel="stylesheet">
  <title>Blockly Demo: Generating JavaScript</title>
  <script src="../../blockly_uncompressed.js"></script>
  <script src="../../blocks_compressed.js"></script>
  <script src="../../javascript_compressed.js"></script>
  <script src="../../python_compressed.js"></script>
  <script src="../../lua_compressed.js"></script>
  <script src="../../msg/js/en.js"></script>
  <script src="../../../Hamster/hamsters.js"></script>
  
  <link href="prism.css" rel="stylesheet" />
  
  <script src="test_block.js"></script>
  <style>
    body {
      background-color: #fff;
      font-family: sans-serif;
    }
    h1 {
      font-weight: normal;
      font-size: 140%;
    }
  </style>
</head>
<body>
<script src="prism.js"></script>
  <h1>Cinderly &gt;
    Task 1 &gt; <a href="task2.html">Task 2</a> &gt;</h1>

  <p style="line-height: 120%">Welcome to the blockly parallel plugin tutorial. 
    In this tutorial you will learn how to use parallel programming to accelerate the code you produce with blockly. <br>
    An important conpcept in parallel programming is function pointers. Try using the funition pointer block below to print "Hello World." <br>
    You may convert the blocks into a language of your choice, so long as your your choice is python. 
  </p>
  <p>
    Show code: 
    <button onclick="showCode('language-python')">Python</button>
      <button disabled onclick="noCode()">JavaScript</button>
      <button disabled onclick="noCode()">PHP</button>
      <button onclick="showCode('language-lua')">Lua</button>
      <button disabled onclick="noCode()">Dart</button>&emsp;
      <button onclick="toggleSolution()">Show Solution</button>
        <!-- <button onclick="runCode()">Run JavaScript</button> -->
      </p>
  <img id="solution" src="task1.jpg" style="display:none;"></img>

  <div id="blocklyDiv" style="height: 80vh; width: 70vw; float: left"></div>

  <xml id="toolbox" style="display: none">
    
    <category name="Logic" colour="%{BKY_LOGIC_HUE}">
	    <block type="procedures_defnoreturn"></block>
      <block type="multiprocess"></block>
      <block type="multiprocess_snippet"></block>
      <block type="functions_get"></block>  
      <block type="variables_get"></block>
	  
      <block type="controls_if"></block>
      <block type="logic_compare"></block>
      <block type="logic_operation"></block>
      <block type="logic_negate"></block>
      <block type="logic_boolean"></block>
      <block type="logic_null"></block>
      <block type="logic_ternary"></block>
    </category>
    <category name="Loops" colour="%{BKY_LOOPS_HUE}">
      <block type="controls_repeat_ext">
        <value name="TIMES">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="controls_whileUntil"></block>
      <block type="controls_for">
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
        <value name="BY">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="controls_forEach"></block>
      <block type="controls_flow_statements"></block>
    </category>
    <category name="Math" colour="%{BKY_MATH_HUE}">
      <block type="math_number">
        <field name="NUM">123</field>
      </block>
      <block type="math_arithmetic">
        <value name="A">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="B">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
      <block type="math_single">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">9</field>
          </shadow>
        </value>
      </block>
      <block type="math_trig">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">45</field>
          </shadow>
        </value>
      </block>
      <block type="math_constant"></block>
      <block type="math_number_property">
        <value name="NUMBER_TO_CHECK">
          <shadow type="math_number">
            <field name="NUM">0</field>
          </shadow>
        </value>
      </block>
      <block type="math_round">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">3.1</field>
          </shadow>
        </value>
      </block>
      <block type="math_on_list"></block>
      <block type="math_modulo">
        <value name="DIVIDEND">
          <shadow type="math_number">
            <field name="NUM">64</field>
          </shadow>
        </value>
        <value name="DIVISOR">
          <shadow type="math_number">
            <field name="NUM">10</field>
          </shadow>
        </value>
      </block>
      <block type="math_constrain">
        <value name="VALUE">
          <shadow type="math_number">
            <field name="NUM">50</field>
          </shadow>
        </value>
        <value name="LOW">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="HIGH">
          <shadow type="math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>
      <block type="math_random_int">
        <value name="FROM">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="TO">
          <shadow type="math_number">
            <field name="NUM">100</field>
          </shadow>
        </value>
      </block>
      <block type="math_random_float"></block>
      <block type="math_atan2">
        <value name="X">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
        <value name="Y">
          <shadow type="math_number">
            <field name="NUM">1</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="Text" colour="%{BKY_TEXTS_HUE}">
      <block type="text"></block>
      <block type="text_join"></block>
      <block type="text_append">
        <value name="TEXT">
          <shadow type="text"></shadow>
        </value>
      </block>
      <block type="text_length">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_isEmpty">
        <value name="VALUE">
          <shadow type="text">
            <field name="TEXT"></field>
          </shadow>
        </value>
      </block>
      <block type="text_indexOf">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">{textVariable}</field>
          </block>
        </value>
        <value name="FIND">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_charAt">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">{textVariable}</field>
          </block>
        </value>
      </block>
      <block type="text_getSubstring">
        <value name="STRING">
          <block type="variables_get">
            <field name="VAR">{textVariable}</field>
          </block>
        </value>
      </block>
      <block type="text_changeCase">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_trim">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_print">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
      <block type="text_prompt_ext">
        <value name="TEXT">
          <shadow type="text">
            <field name="TEXT">abc</field>
          </shadow>
        </value>
      </block>
    </category>
    <category name="Lists" colour="%{BKY_LISTS_HUE}">
      <block type="lists_create_with">
        <mutation items="0"></mutation>
      </block>
      <block type="lists_create_with"></block>
      <block type="lists_repeat">
        <value name="NUM">
          <shadow type="math_number">
            <field name="NUM">5</field>
          </shadow>
        </value>
      </block>
      <block type="lists_length"></block>
      <block type="lists_isEmpty"></block>
      <block type="lists_indexOf">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">{listVariable}</field>
          </block>
        </value>
      </block>
      <block type="lists_getIndex">
        <value name="VALUE">
          <block type="variables_get">
            <field name="VAR">{listVariable}</field>
          </block>
        </value>
      </block>
      <block type="lists_setIndex">
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR">{listVariable}</field>
          </block>
        </value>
      </block>
      <block type="lists_getSublist">
        <value name="LIST">
          <block type="variables_get">
            <field name="VAR">{listVariable}</field>
          </block>
        </value>
      </block>
      <block type="lists_split">
        <value name="DELIM">
          <shadow type="text">
            <field name="TEXT">,</field>
          </shadow>
        </value>
      </block>
      <block type="lists_sort"></block>
    </category>
    <sep></sep>
    <category name="Variables" colour="%{BKY_VARIABLES_HUE}" custom="VARIABLE"></category>
    <category name="Functions" colour="%{BKY_PROCEDURES_HUE}" custom="PROCEDURE"></category>
    <sep></sep>
	<category name="Parallel" colour="#db6a00">
      <block type="functions_get"></block>
	  <block type="run_function_pointer"></block>
    </category>
	
  </xml>
  
  <xml id="startBlocks" style="display: none">
    <block id="ORIGIN_BLOCK" type="procedures_defreturn" deletable="false" name="Test" inline="false" x="20" y="20">
		<field name="NAME">function</field>
		<value name="RETURN">
		  <block type="math_number" id="sR+F3{/hi1;cefJapOGc">
			<field name="NUM">0</field>
		  </block>
		</value>
    </block>
	
	<block id="ORIGIN_BLOCK" type="procedures_defnoreturn"  name="HelloFunc" inline="false" x="380" y="20">
		<field name="NAME">Say Hello</field>
		<comment pinned="false" h="80" w="160">Describe this function...</comment>
		<statement name="STACK">
		  <block type="text_print" id="S_DucsOqEnI~e,7%l;Vi">
			<value name="TEXT">
			  <shadow type="text" id="G8-2R+*50HIyW|*+p.P}">
				<field name="TEXT">Hello World?</field>
			  </shadow>
			</value>
		  </block>
		</statement>
    </block>
	
	<block id="pntrRun" type="run_function_pointer" name="pntrRun" inline="false" x="20" y="300">
    </block>
	
	<block id="pntrGet" type="functions_get" name="pntrGet" inline="false" x="380" y="300">
    </block>
  </xml>
  
  <script>
    var demoWorkspace = Blockly.inject('blocklyDiv',
        {media: '../../media/',
         toolbox: document.getElementById('toolbox')});
    Blockly.Xml.domToWorkspace(document.getElementById('startBlocks'),
                               demoWorkspace);
	PARALLEL_HUE = "#db6a00"
	demoWorkspace.addChangeListener(Blockly.FieldFunction.prototype.onFunctionRename);

    function showCode(lang) {
      // Generate JavaScript code and display it.
      Blockly.JavaScript.INFINITE_LOOP_TRAP = null;
	  if (lang == 'language-python'){
	      var code = Blockly.Python.workspaceToCode(demoWorkspace);
	  }
	  else if (lang == 'language-lua'){
	      var code = Blockly.Lua.workspaceToCode(demoWorkspace);
	  }
      
      resetFunctionCounter()
      document.getElementById('code').textContent = code
	  document.getElementById('code').className = lang
	  Prism.highlightElement(document.getElementById('code'))
    }

    function noCode() {
      alert("Language not implemented yet");
    }
	
	function toggleSolution(){ 
	  if (document.getElementById('solution').style.display == 'none'){
		document.getElementById('solution').style.display = 'block'
	  }
	  else{
		document.getElementById('solution').style.display= 'none';
	  }
	}

    
    
  </script>
  <div dark-code="">Generated Code: 
    <pre><code id="code" class="language-python"></code></pre>
  </div>
  </body>
</html>
